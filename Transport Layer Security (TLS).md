#cryptography 

A cryptographic protocol that ensures secure communication over a network. it is the successor to [[Secure Sockets Layer (SSL)|SSL]] and is widely used to encrypt data, authenticate parties, and ensure data integrity in applications like [[Hypertext Transfer Protocol Secure (HTTPS)|HTTPS]], email, and [[Virtual Private Network (VPN)|VPNs]].
# **TLS Handshake**
TLS establishes a secure connection through a process called the **TLS Handshake**, where encryption and authentication parameters are agreed upon. The process combines **asymmetric encryption** (for secure key exchange) and **symmetric encryption** (for data transfer).
#### **1. Client Hello**
- The client (e.g., a web browser) sends a **Client Hello** message to the server.
- This message includes:
	- **Supported TLS Versions**: Lists the TLS versions the client supports (e.g., TLS 1.2, TLS 1.3).
	- **Cipher Suites**: A list of encryption algorithms (e.g., AES, ChaCha20) and key exchange methods (e.g., RSA, Diffie-Hellman).
	- **Compression Methods**: (Rarely used in modern versions.)
	- **Client Random**: A random number generated by the client for session key generation.
	- Optional: Extensions like **Server Name Indication (SNI)**, which tells the server the domain name the client is requesting.
- **Purpose**:
	 - To inform the server of the client’s capabilities and preferences for establishing a secure session.
#### **2. Server Hello**
- The server responds with a **Server Hello** message, which includes:
	- **Chosen TLS Version**: The highest version supported by both the client and server.
	- **Selected Cipher Suite**: The encryption algorithm and key exchange method chosen from the client’s list.
	- **Server Random**: A random number generated by the server for session key generation.
- **Purpose**:
    - To confirm the protocol version, encryption method, and key exchange mechanism that will be used.
#### **3. Server Certificate**
- The server sends its **digital certificate** to the client. This certificate contains:
	- The server’s public key.
	- The server’s domain name.
	- Information about the Certificate Authority (CA) that issued the certificate.
	- The certificate's expiration date.
- **Purpose**:
    - To authenticate the server’s identity.
    - To provide the server’s public key for secure key exchange.
#### **4. Certificate Validation**
- The client validates the server’s certificate by:
	- Ensuring it is signed by a trusted CA.
	- Checking the domain name in the certificate matches the server's domain.
	- Verifying the certificate has not expired or been revoked (using CRLs or OCSP).
- **Purpose**:
    - To ensure the client is communicating with the legitimate server and not a malicious actor.
#### **5. Key Exchange and Pre-Master Secret Generation**
Key exchange can occur in two primary ways, depending on the selected cipher suite:
 **a. RSA Key Exchange** (Legacy method, less secure):
- The client generates a **pre-master secret** (a random number) and encrypts it with the server’s public key (from the certificate).
- The encrypted pre-master secret is sent to the server.
- The server decrypts it using its private key.
**b. Diffie-Hellman Key Exchange** (Modern and secure):
- Both client and server exchange **ephemeral Diffie-Hellman public keys**.
- Using these, both parties compute the same **pre-master secret** independently.
#### **6. Session Key Derivation**
2. **What Happens**:
    - Both client and server use the **pre-master secret**, along with the **client random** and **server random**, to generate the same **session key** using a key derivation function (KDF).
    - The session key will be used for encrypting and decrypting all subsequent communication.
3. **Purpose**:
    - To create a symmetric key for fast and secure communication.
#### **7. Finished Messages**
4. **What Happens**:
    - The client sends a **Finished** message encrypted with the session key, signaling that it is ready to use the secure connection.
    - The server responds with its own encrypted **Finished** message.
5. **Purpose**:
    - To confirm that the handshake was successful and that both parties are using the same session key.
#### **8. Secure Data Transmission**
6. **What Happens**:
    - Once the handshake is complete, all data exchanged between the client and server is encrypted using symmetric encryption (e.g., AES).
    - Each message is also authenticated to ensure integrity using HMAC (Hash-Based Message Authentication Code).
7. **Purpose**:
    - To securely transmit data, such as web pages, passwords, or credit card information.
---
# **TLS Versions**
1. **TLS 1.0**:
    - **Released**: 1999.
    - **Description**: TLS 1.0 is based on SSL 3.0, but it includes more secure cryptographic algorithms and fixes for some of SSL's flaws.
    - **Vulnerabilities**: Still has some weaknesses, especially with older ciphers and lack of forward secrecy.
2. **TLS 1.1**:
    - **Released**: 2006.
    - **Description**: TLS 1.1 improved upon TLS 1.0 with better protection against certain attacks, like cipher-block chaining (CBC) attacks.
    - **Vulnerabilities**: Still vulnerable to some types of attacks (e.g., padding oracle attacks), and it has been largely deprecated in favor of TLS 1.2.
3. **TLS 1.2**:
    - **Released**: 2008.
    - **Description**: TLS 1.2 brought significant improvements in security, including support for stronger encryption algorithms, and it is widely adopted.
    - **Vulnerabilities**: Fewer vulnerabilities than earlier versions, though issues like BEAST (Browser Exploit Against SSL/TLS) were mitigated in later updates.
4. **TLS 1.3**:
    - **Released**: 2018.
    - **Description**: TLS 1.3 is the latest version and includes more robust security features, such as forward secrecy and the removal of obsolete cryptographic algorithms. It reduces handshake latency and improves overall performance.
    - **Vulnerabilities**: Much more secure than earlier versions, though still not immune to future vulnerabilities as cryptography advances.
	### **Which Version to Use?**
- **TLS 1.2** and **TLS 1.3** are the recommended protocols for secure communications today. SSL and earlier TLS versions (1.0, 1.1) are deprecated due to known vulnerabilities.
- **TLS 1.3** should be prioritized, as it offers improved security and performance over **TLS 1.2**.
---