# **Bandit**
### **Bandit 0**
```bash
$ cat readme
ZjLjTmM6FvvyRnrb2rfNWOZOTa6ip5If
```
### **Bandit 1**
```bash
$ cat ./-
263JGJPfgU6LtdEvgfWU1XP5yac29mFx
```
### **Bandit 2**
```bash
$ cat spaces\ in\ this\ filename
MNk8KNH3Usiio41PRUEoDFPqfxLPlSmx
```
### **Bandit 3**
```bash
cd inhere
ls -a
cat ...Hiding-From-You
2WmrDFRmJIq3IPxneAaMGhap0pFhF3NJ
```
### **Bandit 4**
```bash
cd inhere
file ./*
cat ./-file07
4oQYVPkxZOOEOO5pTW81FB8j8lxXGUQw
```
### **Bandit 5**
```bash
cd inhere
find -type f -readable ! -executable -size 1033c
cat maybehere07/.file2
HWasnPhtq9AVKe0dmk45nxy20cvUa6EG
```
### **Bandit 6**
```bash
find / -user bandit7 -group bandit6 -size 33c 2> /dev/null
cat /var/lib/dpkg/info/bandit7.password
morbNTDkSW6jIlUc0ymOdMaLnOlFVAaj
```
### **Bandit 7**
```bash
grep "millionth" data.txt
dfwvzFQi4mU0wfNbFOe9RoWskMLg7eEc
```
### **Bandit 8**
```bash
sort data.txt | uniq -u 
4CKMh1JI91bUIZZPXDqGanal4xvAg0JM
```
### **Bandit 9**
```bash
$ strings data.txt | grep "=="
FGUW5ilLVJrxX9kMYMmlN4MgbpfMiqey
```
### **Bandit 10**
```bash
base64 --decode data.txt
dtR173fZKb0RRsDFSGsg2RWnpNVj3qRr
```
### **Bandit 11**
```bash
cat data.txt | tr 'A-Za-z' 'N-ZA-Mn-za-m'
7x16WNeHIi5YkIhWsfFIqoognUTyj9Q4
```
### **Bandit 12**
```bash
cd '$(mktemp -d)'
cp ~/data.txt data.hex
xxd -r data.hex > data_compressed
file data_compressed
gzip -d
bzip2 -d
gzip -d
tar -xv
bzip2 -d
tar -xv
gzip -d
cat data8
FO5dwFsc0cbaIiH0h8J2eUks2vdTDwAn
```
### **Bandit 13**
```bash
cat sshkey.private # copy this
exit
vim sshkey.private # past here
chmod 600 sshkey.private
ssh bandit14@bandit.labs.overthewire.org -p 2220 -i sshkey.private
cat /etc/bandit_pass/bandit14
MU4VWeTyJk8ROof1qqmcBPaLh7lDCPvS
```
### **Bandit 14**
```bash
nc localhost 30000
MU4VWeTyJk8ROof1qqmcBPaLh7lDCPvS
Correct!
8xCjnmgoKbGLhHFAZlGE5Tmu4M2tKJQo
```
### **Bandit 15**
```bash
openssl s_client -connect localhost:30001
8xCjnmgoKbGLhHFAZlGE5Tmu4M2tKJQo
Correct!
kSkvUpMQ7lBYyCM4GBPvCvT1BfWRy0Dx
```
### **Bandit 16**
```bash
bash openssl s_client -connect localhost:31790
-----BEGIN RSA PRIVATE KEY-----
MIIEogIBAAKCAQEAvmOkuifmMg6HL2YPIOjon6iWfbp7c3jx34YkYWqUH57SUdyJ
imZzeyGC0gtZPGujUSxiJSWI/oTqexh+cAMTSMlOJf7+BrJObArnxd9Y7YT2bRPQ
Ja6Lzb558YW3FZl87ORiO+rW4LCDCNd2lUvLE/GL2GWyuKN0K5iCd5TbtJzEkQTu
DSt2mcNn4rhAL+JFr56o4T6z8WWAW18BR6yGrMq7Q/kALHYW3OekePQAzL0VUYbW
JGTi65CxbCnzc/w4+mqQyvmzpWtMAzJTzAzQxNbkR2MBGySxDLrjg0LWN6sK7wNX
x0YVztz/zbIkPjfkU1jHS+9EbVNj+D1XFOJuaQIDAQABAoIBABagpxpM1aoLWfvD
KHcj10nqcoBc4oE11aFYQwik7xfW+24pRNuDE6SFthOar69jp5RlLwD1NhPx3iBl
J9nOM8OJ0VToum43UOS8YxF8WwhXriYGnc1sskbwpXOUDc9uX4+UESzH22P29ovd
d8WErY0gPxun8pbJLmxkAtWNhpMvfe0050vk9TL5wqbu9AlbssgTcCXkMQnPw9nC
YNN6DDP2lbcBrvgT9YCNL6C+ZKufD52yOQ9qOkwFTEQpjtF4uNtJom+asvlpmS8A
vLY9r60wYSvmZhNqBUrj7lyCtXMIu1kkd4w7F77k+DjHoAXyxcUp1DGL51sOmama
+TOWWgECgYEA8JtPxP0GRJ+IQkX262jM3dEIkza8ky5moIwUqYdsx0NxHgRRhORT
8c8hAuRBb2G82so8vUHk/fur85OEfc9TncnCY2crpoqsghifKLxrLgtT+qDpfZnx
SatLdt8GfQ85yA7hnWWJ2MxF3NaeSDm75Lsm+tBbAiyc9P2jGRNtMSkCgYEAypHd
HCctNi/FwjulhttFx/rHYKhLidZDFYeiE/v45bN4yFm8x7R/b0iE7KaszX+Exdvt
SghaTdcG0Knyw1bpJVyusavPzpaJMjdJ6tcFhVAbAjm7enCIvGCSx+X3l5SiWg0A
R57hJglezIiVjv3aGwHwvlZvtszK6zV6oXFAu0ECgYAbjo46T4hyP5tJi93V5HDi
Ttiek7xRVxUl+iU7rWkGAXFpMLFteQEsRr7PJ/lemmEY5eTDAFMLy9FL2m9oQWCg
R8VdwSk8r9FGLS+9aKcV5PI/WEKlwgXinB3OhYimtiG2Cg5JCqIZFHxD6MjEGOiu
L8ktHMPvodBwNsSBULpG0QKBgBAplTfC1HOnWiMGOU3KPwYWt0O6CdTkmJOmL8Ni
blh9elyZ9FsGxsgtRBXRsqXuz7wtsQAgLHxbdLq/ZJQ7YfzOKU4ZxEnabvXnvWkU
YOdjHdSOoKvDQNWu6ucyLRAWFuISeXw9a/9p7ftpxm0TSgyvmfLF2MIAEwyzRqaM
77pBAoGAMmjmIJdjp+Ez8duyn3ieo36yrttF5NSsJLAbxFpdlc1gvtGCWW+9Cq0b
dxviW8+TFVEBl1O4f7HVm6EpTscdDxU+bCXWkfjuRb7Dy9GOtt9JPsX8MBTakzh3
vBgsyi/sN3RqRBcGU40fOoZyfAMT8s1m/uYv52O6IgeuZ/ujbjY=
-----END RSA PRIVATE KEY-----
```
### **Bandit 17**
```bash
diff passwords.old  passwords.new
x2gLTTjFwMOhQ8oWNbMN362QKxfRqGlO
```
### **Bandit 18**
```bash
ssh bandit18@bandit.labs.overthewire.org -p 2220 "cat readme"
cGWpMaKXVwDUNgPAVJbWYuGHVn9zl3j8
```
### **Bandit 19**
```bash
./bandit20-do cat /etc/bandit_pass/bandit20
0qXahG8ZjOVMN9Ghs7iOWsCfZyXOUbYO
```
### **Bandit 20**
```bash
tmux
nc -lvp 2001
# switch to another terminal session
./suconnect 2001
# switch back
# past "0qXahG8ZjOVMN9Ghs7iOWsCfZyXOUbYO"
EeoULMCra2q0dSkYj561DX7s1CpBuOBt
```
### **Bandit 21**
```bash
$ ls /etc/cron.d/
$ cat /etc/cron.d/cronjob_bandit22
$ cat /usr/bin/cronjob_bandit22.sh
$ cat /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv
tRae0UfB9v0UzbCdn9cY0gQnds9GF58Q
```
### **Bandit 22**
```bash
$ cat cronjob_bandit23 
$ cat /usr/bin/cronjob_bandit23.sh
$ myvar=$(echo I am user bandit23 | md5sum | cut -d ' ' -f 1)
$ cat /usr/bin/cronjob_bandit23.sh 
$ cat /tmp/$myvar
0Zf11ioIjMVN551jX3CmStKLYqjk54Ga
```
### **Bandit 23** 
```bash
$ cd /etc/cron.d/
$ ls
cronjob_bandit22  cronjob_bandit24  otw-tmp-dir
cronjob_bandit23  e2scrub_all       sysstat
$ cat cronjob_bandit24 
@reboot bandit24 /usr/bin/cronjob_bandit24.sh &> /dev/null
* * * * * bandit24 /usr/bin/cronjob_bandit24.sh &> /dev/null
$ cat /usr/bin/cronjob_bandit24.sh 
#!/bin/bash
myname=$(whoami)
cd /var/spool/$myname/foo
echo "Executing and deleting all scripts in /var/spool/$myname/foo:"
for i in * .*;
do
    if [ "$i" != "." -a "$i" != ".." ];
    then
        echo "Handling $i"
        owner="$(stat --format "%U" ./$i)"
        if [ "${owner}" = "bandit23" ]; then
            timeout -s 9 60 ./$i
        fi
        rm -f ./$i
    fi
done
```
From the script above we can see that all the scripts in `/var/spool/bandit24/foo` that are owned by me "bandit23" are being executed before being deleted. meaning that if i create a script there then it will run.
```bash
$ cd /var/spool/bandit24/foo
$ echo "cat /etc/bandit_pass/bandit24 > /tmp/password24" > /var/myscript.sh 
$ chmod +x myscript.sh
```
Wait a bit for the script to execute then check.
```bash
$ cat /tmp/password24
gb8KRRCsshuZXI0tUuR6ypOFjiZbf3G8
```
### **Bandit 24** -------------------------------
We need to send the password to `localhost` on port `30002`, which can be done by: 
```bash
$ echo "password" | netcat localhost 30002
```
But the password is of the following format
```
<bandit_24_password> <PIN>
```
Where `PIN` could be any 4-digit pin code. So we're going to [[Brute Force]] the password.
```bash
$ vim /tmp/myshit.sh
for i in {0..9999}; do 
	echo "gb8KRRCsshuZXI0tUuR6ypOFjiZbf3G8 $i";
done | nc localhost 30002
$ chmod +x /tmp/myshit.sh
$ /tmp/myshit.sh
I am the pincode checker for user bandit25. Please enter the password for user bandit24 and the secret pincode on a single line, separated by a space.
Wrong! Please enter the correct current password and pincode. Try again.
Wrong! Please enter the correct current password and pincode. Try again.
...SNIP...
Correct!
The password of user bandit25 is iCi86ttT4KSNe1armKiwbQNmB3YJP3q4
```
PS: We can write the script in one command.
```bash
$ for i in {0..9999}; do echo "gb8KRRCsshuZXI0tUuR6ypOFjiZbf3G8 $i";  done | nc localhost 30002
```
### **Bandit 25**
```bash
$ ls
bandit26.sshkey
```
We have the private key needed to connect to the next level, but according to the instructions, the next level "bandit27" isn't using bash, so lets check what is it using.
```bash
$ cat /etc/passwd
bandit26:x:11026:11026:bandit level 26:/home/bandit26:/usr/bin/showtext
```
It is using `/usr/bin/showtext`, lets check its contents:
```bash
$ cat /usr/bin/showtext 
#!/bin/sh
export TERM=linux
exec more ~/text.txt
exit 0
```
From this we can see that if we try to ssh to bandit27, the command `more ~/text.txt` will run instead of the `bash` shell.
```bash
$ ssh bandit27@localhost -p 2220 -i bandit26.sshkey
  _                     _ _ _   ___   __  
 | |                   | (_) | |__ \ / /  
 | |__   __ _ _ __   __| |_| |_   ) / /_  
 | '_ \ / _` | '_ \ / _` | | __| / / '_ \ 
 | |_) | (_| | | | | (_| | | |_ / /| (_) |
 |_.__/ \__,_|_| |_|\__,_|_|\__|____\___/ 
Connection to localhost closed.
```
We see that the connection is immediatly closed.
So there is a clever trick here, since `more ~/text.txt` is running and full displaying everything, if we make the terminal window smaller, `more` will keep running since it only displays a portion, and if we click `v` we switch to `vi` mode that allows us to execute shell commands.
```bash
  _                     _ _ _   ___   __  
 | |                   | (_) | |__ \ / /  
 | |__   __ _ _ __   __| |_| |_   ) / /_  
 | '_ \ / _` | '_ \ / _` | | __| / / '_ \ 
--More--(66%)
```
PRESS `v` to switch to `vi` mode
```
  _                     _ _ _   ___   __
 | |                   | (_) | |__ \ / /  
 | |__   __ _ _ __   __| |_| |_   ) / /_  
 | '_ \ / _` | '_ \ / _` | | __| / / '_ \
Type  :qa  and press <Enter> to exit Vim                     1,3         Top
```
Change the shell for vi and run it.
```bash
:set shell=/bin/bash
:shell
bandit26@bandit:~$ ls
bandit27-do  text.txt
```
Now we can the password for bandit26 (this host)
```bash
bandit26@bandit:~$ cat /etc/bandit_pass/bandit26
s0773xxkk0MXfdqOfPRVr9L3jJBUOgCZ
```
### **Bandit 26**
This level is solved from the aquired shell on the previous level.
```bash
bandit26@bandit:~$ ls
bandit27-do  text.txt
bandit26@bandit:~$ ./bandit27-do 
Run a command as another user.
  Example: ./bandit27-do id
bandit26@bandit:~$ ./bandit27-do cat /etc/bandit_pass/bandit27
upsNCc7vzaRDx6oZC6GiR6ERwe1MowGB
```
### **Bandit 27**
Create a temporary directory to work in.
```bash
$ cd $(mktemp -d)
$ git clone ssh://bandit27-git@localhost:2220/home/bandit27-git/repo
passowrd: ********
Receiving objects: 100% (3/3), done.
$ ls repo
README
$ cat README
The password to the next level is: Yz9IpL0sBcCeuG7m9uQFt8ZNpS4HZRcN
```
### **Bandit 28**
Create a temporary directory to work in.
```bash
$ cd $(mktemp -d)
$ git clone ssh://bandit28-git@localhost:2220/home/bandit28-git/repo
Receiving objects: 100% (2/2), done.
$ cat README
# Bandit Notes
Some notes for level29 of bandit.
## credentials
- username: bandit29
- password: xxxxxxxxxx
```
The password is hidden, hmmm, lets check the git logs
```bash
$ git log
commit 817e303aa6c2b207ea043c7bba1bb7575dc4ea73 (HEAD -> master, origin/master, origin/HEAD)
Author: Morla Porla <morla@overthewire.org>
Date:   Thu Sep 19 07:08:39 2024 +0000

    fix info leak

commit 3621de89d8eac9d3b64302bfb2dc67e9a566decd
Author: Morla Porla <morla@overthewire.org>
Date:   Thu Sep 19 07:08:39 2024 +0000

    add missing data

commit 0622b73250502618babac3d174724bb303c32182
Author: Ben Dover <noone@overthewire.org>
Date:   Thu Sep 19 07:08:39 2024 +0000

    initial commit of README.md
```
We can see that the last commit "fix info leak" was done to hide the password that was leaked. so lets rollback.
```bash
$ git checkout 3621de89d8eac9d3b64302bfb2dc67e9a566decd
$ cat README.md 
# Bandit Notes
Some notes for level29 of bandit.
## credentials
- username: bandit29
- password: 4pT1t5DENaYuqnqvadYs1oE4QLCdjmJ7
```
### **Bandit 29**
```bash
$ git clone ssh://bandit29-git@localhost:2220/home/bandit29-git/repo
$ cd repo
$ cat README.md 
# Bandit Notes
Some notes for bandit30 of bandit.
## credentials
- username: bandit30
- password: <no passwords in production!>
```

```bash
$ git branch -r
origin/HEAD -> origin/master
origin/dev
origin/master
origin/sploits-dev
$ git checkout dev
```

```bash
$ cat README.md 
# Bandit Notes
Some notes for bandit30 of bandit.
## credentials
- username: bandit30
- password: qp30ex3VLz5MDG1n91YowTv4Q8l7CDZL
```
### **Bandit 30**
```bash
$ git tag
secret
$ git show secret
fb5S2xb7bRyFmAvQYQGEqsbhVyJqhnDy
```
### **Bandit 31**
```bash
$ cat README.md
This time your task is to push a file to the remote repository.
Details:
    File name: key.txt
    Content: 'May I come in?'
    Branch: master

$ echo "May I come in?" > "key.txt"
$ ls -a
.git/ .gitignore README.md
$ cat .gitignore 
*.txt
$ rm .gitignore
$ git add .
$ git commit -m "get me in bois"
remote: Well done! Here is the password for the next level:
remote: 3O9RfhqyAlVBEZpVb6LYStshZoqoSx5K 
```
### **Bandit 32**
```bash
WELCOME TO THE UPPERCASE SHELL
>> pwd
sh: 1: PWD: Permission denied
>> $0
$
```

```bash
$ cat /etc/bandit_pass/bandit33
tQdtbs5D5i2vJwkO8mEyYEyTL8izoeJ0
```
## **Resources**
- https://www.youtube.com/playlist?list=PLBf0hzazHTGOIn_vuuuCzRFVhYiDBnJID

# **Leviathan**